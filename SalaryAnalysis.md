108-2 大數據分析方法 作業一
================
yenhsiu liu

搞不清楚各行各業的薪資差異嗎? 念研究所到底對第一份工作的薪資影響有多大? CP值高嗎? 透過分析**初任人員平均經常性薪資**-
（107年）<https://data.gov.tw/dataset/6647>
（104-105年）<http://ipgod.nchc.org.tw/dataset/a17000000j-020066>
，可初步了解台灣近幾年各行各業、各學歷的起薪。

## 比較104年度和107年度大學畢業者的薪資資料

### 資料匯入與處理

``` r
library(readr)
library(jsonlite)
library(dplyr)
```

    ## 
    ## Attaching package: 'dplyr'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     filter, lag

    ## The following objects are masked from 'package:base':
    ## 
    ##     intersect, setdiff, setequal, union

``` r
education107 <- read_csv("C:/Users/user/Downloads/hw/107education.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   年度 = col_double(),
    ##   大職業別 = col_character(),
    ##   `經常性薪資-薪資` = col_character(),
    ##   `經常性薪資-女/男` = col_character(),
    ##   `國中及以下-薪資` = col_character(),
    ##   `國中及以下-女/男` = col_character(),
    ##   `高中或高職-薪資` = col_character(),
    ##   `高中或高職-女/男` = col_character(),
    ##   `專科-薪資` = col_character(),
    ##   `專科-女/男` = col_character(),
    ##   `大學-薪資` = col_character(),
    ##   `大學-女/男` = col_character(),
    ##   `研究所-薪資` = col_character(),
    ##   `研究所-女/男` = col_character()
    ## )

``` r
education104 <- read_csv("C:/Users/user/Downloads/hw/104education.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   年度 = col_double(),
    ##   大職業別 = col_character(),
    ##   `經常性薪資-薪資` = col_double(),
    ##   `經常性薪資-女/男` = col_character(),
    ##   `國中及以下-薪資` = col_character(),
    ##   `國中及以下-女/男` = col_character(),
    ##   `高中或高職-薪資` = col_character(),
    ##   `高中或高職-女/男` = col_character(),
    ##   `專科-薪資` = col_character(),
    ##   `專科-女/男` = col_character(),
    ##   `大學-薪資` = col_character(),
    ##   `大學-女/男` = col_character(),
    ##   `研究所及以上-薪資` = col_character(),
    ##   `研究所及以上-女/男` = col_character()
    ## )

``` r
education104$大職業別<-gsub("部門","",education104$大職業別)
education104$大職業別<-gsub("、","_",education104$大職業別)
education104$大職業別<-gsub("營造業","營建工程",education104$大職業別)
education104$大職業別<-
  gsub("資訊及通訊傳播","出版、影音製作、傳播及資通訊服務",education104$大職業別)
education104$大職業別<-gsub("醫療保健服務","醫療保健",education104$大職業別)
education104$大職業別<-gsub("教育服務","教育",education104$大職業別)
```

### 107年度薪資較104年度薪資高的職業有哪些?

``` r
wage104<-education104[,c(2,11)]
wage107<-education107[,c(2,11)]
names(wage104)[2]<-"104大學-薪資"
names(wage107)[2]<-"107大學-薪資"
wage104$`104大學-薪資`<-gsub("—","",wage104$`104大學-薪資`)
wage107$`107大學-薪資`<-gsub("—|…","",wage107$`107大學-薪資`)
wage<-inner_join(wage104,wage107,by="大職業別")
str(wage)
```

    ## Classes 'tbl_df', 'tbl' and 'data.frame':    140 obs. of  3 variables:
    ##  $ 大職業別    : chr  "工業及服務業" "工業及服務業-專業人員" "工業及服務業-技術員及助理專業人員" "工業及服務業-事務支援人員" ...
    ##  $ 104大學-薪資: chr  "27655" "30920" "27886" "26087" ...
    ##  $ 107大學-薪資: chr  "28849" "32317" "29216" "27223" ...

``` r
wage$`104大學-薪資`<-as.numeric(as.character(wage$`104大學-薪資`))
wage$`107大學-薪資`<-as.numeric(as.character(wage$`107大學-薪資`))
wage<-wage[complete.cases(wage),]
wage$薪資比例<-wage$`107大學-薪資`/wage$`104大學-薪資`
wage<-wage[order(wage$薪資比例,decreasing=T),]
knitr::kable(head(wage,10))
```

| 大職業別                   | 104大學-薪資 | 107大學-薪資 |   薪資比例   |
| :--------------------- | :------: | :------: | :------: |
| 專業\_科學及技術服務業-服務及銷售工作人員 |  24423   |  28304   | 1.158908 |
| 教育業-服務及銷售工作人員          |  24324   |  27543   | 1.132338 |
| 不動產業-技術員及助理專業人員        |  27338   |  30914   | 1.130807 |
| 住宿及餐飲業-服務及銷售工作人員       |  23548   |  26111   | 1.108842 |
| 藝術\_娛樂及休閒服務業-事務支援人員    |  24244   |  26611   | 1.097632 |
| 金融及保險業-技藝\_機械設備操作及組裝人員 |  30074   |  32997   | 1.097194 |
| 教育業                    |  25162   |  27582   | 1.096177 |
| 教育業-事務支援人員             |  23643   |  25908   | 1.095800 |
| 用水供應及污染整治業-專業人員        |  32179   |  34957   | 1.086330 |
| 教育業-專業人員               |  26615   |  28911   | 1.086267 |

``` r
#從表格可以看出來前幾名比較多是【服務及銷售工作人員】和【教育業】，可能服務及銷售人員的薪資漲幅比較跟抽成還有景氣有關係，教育業則因為現在少子化會比較專注培養小孩子有關聯，不過這些漲幅比較大的行業大多原本薪資就沒有很高。
```

### 提高超過5%的的職業有哪些?

``` r
wage<-wage[wage$薪資比例>1.05,]
knitr::kable(wage)
```

| 大職業別                         | 104大學-薪資 | 107大學-薪資 |   薪資比例   |
| :--------------------------- | :------: | :------: | :------: |
| 專業\_科學及技術服務業-服務及銷售工作人員       |  24423   |  28304   | 1.158908 |
| 教育業-服務及銷售工作人員                |  24324   |  27543   | 1.132338 |
| 不動產業-技術員及助理專業人員              |  27338   |  30914   | 1.130807 |
| 住宿及餐飲業-服務及銷售工作人員             |  23548   |  26111   | 1.108842 |
| 藝術\_娛樂及休閒服務業-事務支援人員          |  24244   |  26611   | 1.097632 |
| 金融及保險業-技藝\_機械設備操作及組裝人員       |  30074   |  32997   | 1.097194 |
| 教育業                          |  25162   |  27582   | 1.096177 |
| 教育業-事務支援人員                   |  23643   |  25908   | 1.095800 |
| 用水供應及污染整治業-專業人員              |  32179   |  34957   | 1.086330 |
| 教育業-專業人員                     |  26615   |  28911   | 1.086267 |
| 出版、影音製作、傳播及資通訊服務業-專業人員       |  29352   |  31763   | 1.082141 |
| 住宿及餐飲業                       |  25167   |  27213   | 1.081297 |
| 用水供應及污染整治業-技藝\_機械設備操作及組裝人員   |  27887   |  29909   | 1.072507 |
| 營建工程-服務及銷售工作人員               |  26782   |  28707   | 1.071877 |
| 電力及燃氣供應業-技藝\_機械設備操作及組裝人員     |  28039   |  30031   | 1.071044 |
| 住宿及餐飲業-事務支援人員                |  24786   |  26538   | 1.070685 |
| 運輸及倉儲業-技術員及助理專業人員            |  29670   |  31747   | 1.070003 |
| 服務業-服務及銷售工作人員                |  24812   |  26527   | 1.069120 |
| 金融及保險業-技術員及助理專業人員            |  30495   |  32602   | 1.069093 |
| 金融及保險業-服務及銷售工作人員             |  28213   |  30134   | 1.068089 |
| 出版、影音製作、傳播及資通訊服務業-事務支援人員     |  25728   |  27464   | 1.067475 |
| 工業及服務業-服務及銷售工作人員             |  25831   |  27551   | 1.066587 |
| 不動產業                         |  27657   |  29494   | 1.066421 |
| 運輸及倉儲業-技藝\_機械設備操作及組裝人員       |  29168   |  31085   | 1.065723 |
| 不動產業-技藝\_機械設備操作及組裝人員         |  25204   |  26802   | 1.063403 |
| 住宿及餐飲業-技藝\_機械設備操作及組裝人員       |  26276   |  27913   | 1.062300 |
| 不動產業-服務及銷售工作人員               |  25806   |  27409   | 1.062117 |
| 支援服務業-服務及銷售工作人員              |  24810   |  26321   | 1.060903 |
| 營建工程-專業人員                    |  31014   |  32897   | 1.060715 |
| 出版、影音製作、傳播及資通訊服務業            |  27478   |  29143   | 1.060594 |
| 運輸及倉儲業-事務支援人員                |  26079   |  27650   | 1.060240 |
| 藝術\_娛樂及休閒服務業                 |  25615   |  27147   | 1.059809 |
| 醫療保健業-服務及銷售工作人員              |  25106   |  26549   | 1.057476 |
| 其他服務業-服務及銷售工作人員              |  22179   |  23443   | 1.056991 |
| 營建工程-事務支援人員                  |  25281   |  26721   | 1.056960 |
| 藝術\_娛樂及休閒服務業-專業人員            |  28351   |  29955   | 1.056577 |
| 運輸及倉儲業                       |  28404   |  30002   | 1.056260 |
| 藝術\_娛樂及休閒服務業-技藝\_機械設備操作及組裝人員 |  25739   |  27180   | 1.055985 |
| 製造業-技術員及助理專業人員               |  27247   |  28746   | 1.055015 |
| 運輸及倉儲業-服務及銷售工作人員             |  27757   |  29262   | 1.054221 |
| 金融及保險業                       |  30787   |  32448   | 1.053951 |
| 工業-技術員及助理專業人員                |  27429   |  28894   | 1.053411 |
| 不動產業-事務支援人員                  |  25632   |  27001   | 1.053410 |
| 金融及保險業-專業人員                  |  33706   |  35490   | 1.052928 |
| 批發及零售業-服務及銷售工作人員             |  24329   |  25614   | 1.052818 |
| 製造業-專業人員                     |  30377   |  31972   | 1.052507 |
| 出版、影音製作、傳播及資通訊服務業-服務及銷售工作人員  |  26210   |  27586   | 1.052499 |
| 出版、影音製作、傳播及資通訊服務業-技術員及助理專業人員 |  27470   |  28910   | 1.052421 |
| 工業-專業人員                      |  30546   |  32145   | 1.052347 |
| 用水供應及污染整治業                   |  28464   |  29943   | 1.051960 |
| 藝術\_娛樂及休閒服務業-技術員及助理專業人員      |  26523   |  27887   | 1.051427 |
| 營建工程                         |  27748   |  29154   | 1.050670 |
| 工業-技藝\_機械設備操作及組裝人員           |  25890   |  27193   | 1.050328 |

``` r
#以上是所有高於5%的職業
```

### 主要的職業種別是哪些種類呢?

``` r
listwage<-wage$大職業別%>%strsplit("-")
for(i in 1:53)
{
  listwage[i]<-listwage[[i]][1]
}
cleanwage<-unlist(listwage)
knitr::kable(table(cleanwage))
```

| cleanwage         | Freq |
| :---------------- | ---: |
| 工業                |    3 |
| 工業及服務業            |    1 |
| 不動產業              |    5 |
| 支援服務業             |    1 |
| 出版、影音製作、傳播及資通訊服務業 |    5 |
| 用水供應及污染整治業        |    3 |
| 住宿及餐飲業            |    4 |
| 批發及零售業            |    1 |
| 其他服務業             |    1 |
| 服務業               |    1 |
| 金融及保險業            |    5 |
| 專業\_科學及技術服務業      |    1 |
| 教育業               |    4 |
| 運輸及倉儲業            |    5 |
| 電力及燃氣供應業          |    1 |
| 製造業               |    2 |
| 營建工程              |    4 |
| 醫療保健業             |    1 |
| 藝術\_娛樂及休閒服務業      |    5 |

``` r
#主要的職業有【不動產業】、【出版、影音製作、傳播及資通訊服務業】、【金融及保險業】、【運輸及倉儲業】、【藝術_娛樂及休閒服務業】
```

## 男女同工不同酬現況分析

男女同工不同酬一直是性別平等中很重要的問題，分析資料來源為103到106年度的大學畢業薪資。

### 104和107年度的大學畢業薪資資料，哪些行業男生薪資比女生薪資多?

``` r
mfratio104<-education104[,c(2,12)]
mfratio107<-education107[,c(2,12)]

mfratio104$`大學-女/男`<-gsub("—|…","",mfratio104$`大學-女/男`)
mfratio107$`大學-女/男`<-gsub("—|…","",mfratio107$`大學-女/男`)

mfratio104$`大學-女/男`<-as.numeric(as.character(mfratio104$`大學-女/男`))
mfratio107$`大學-女/男`<-as.numeric(as.character(mfratio107$`大學-女/男`))
mfratio104<-mfratio104[complete.cases(mfratio104),]
mfratio107<-mfratio107[complete.cases(mfratio107),]
mfratio104[order(mfratio104$`大學-女/男`),]%>%head(10)%>%knitr::kable()
```

| 大職業別                       | 大學-女/男 |
| :------------------------- | :----: |
| 電力及燃氣供應業-技藝\_機械設備操作及組裝人員   | 91.69  |
| 教育業-服務及銷售工作人員              | 91.90  |
| 礦業及土石採取業-技術員及助理專業人員        | 92.42  |
| 礦業及土石採取業-技藝\_機械設備操作及組裝人員   | 93.10  |
| 礦業及土石採取業                   | 95.28  |
| 其他服務業-事務支援人員               | 95.47  |
| 營建工程-技藝\_機械設備操作及組裝人員       | 95.64  |
| 用水供應及污染整治業-技藝\_機械設備操作及組裝人員 | 95.90  |
| 營建工程                       | 96.35  |
| 教育業                        | 96.44  |

``` r
mfratio107[order(mfratio107$`大學-女/男`),]%>%head(10)%>%knitr::kable()
```

| 大職業別                 | 大學-女/男 |
| :------------------- | :----: |
| 礦業及土石採取業-專業人員        | 96.02  |
| 電力及燃氣供應業-事務支援人員      | 96.96  |
| 礦業及土石採取業             | 97.11  |
| 營建工程                 | 97.52  |
| 教育業-事務支援人員           | 97.61  |
| 電力及燃氣供應業-服務及銷售工作人員   | 97.73  |
| 營建工程-技術員及助理專業人員      | 97.78  |
| 用水供應及污染整治業-專業人員      | 97.81  |
| 用水供應及污染整治業-服務及銷售工作人員 | 97.94  |
| 電力及燃氣供應業-專業人員        | 98.23  |

``` r
#04年和07年男生薪資比女生多的行業較多是電然氣或是礦業土石業類別，這些職業女生本來就比較少，因為大部分是需要力氣或是在炎熱的環境下工作的條件，故願意聘請女生的意願很低也比較不會給出高於男生的薪水。
```

### 哪些行業女生薪資比男生薪資多?

``` r
mfratio104[order(mfratio104$`大學-女/男`,decreasing=T),]%>%
  filter(`大學-女/男`>99.99)%>%head(10)%>%
  knitr::kable()
```

| 大職業別                         | 大學-女/男 |
| :--------------------------- | :----: |
| 專業\_科學及技術服務業-技藝\_機械設備操作及組裝人員 | 100.26 |
| 用水供應及污染整治業-服務及銷售工作人員         | 100.00 |
| 不動產業-技藝\_機械設備操作及組裝人員         | 100.00 |
| 醫療保健業-服務及銷售工作人員              | 100.00 |
| 其他服務業-專業人員                   | 100.00 |

``` r
mfratio107[order(mfratio107$`大學-女/男`,decreasing=T),]%>%
  filter(`大學-女/男`>99.99)%>%head(10)%>%
  knitr::kable()
```

| 大職業別                              | 大學-女/男 |
| :-------------------------------- | :----: |
| 礦業及土石採取業-技藝\_機械設備操作及組裝人員          |  100   |
| 出版、影音製作、傳播及資通訊服務業-技藝\_機械設備操作及組裝人員 |  100   |
| 金融及保險業-服務及銷售工作人員                  |  100   |
| 金融及保險業-技藝\_機械設備操作及組裝人員            |  100   |
| 不動產業-服務及銷售工作人員                    |  100   |
| 不動產業-技藝\_機械設備操作及組裝人員              |  100   |
| 專業\_科學及技術服務業-服務及銷售工作人員            |  100   |
| 教育業-服務及銷售工作人員                     |  100   |

``` r
#在04年的時候還有【專業_科學及技術服務業-技藝_機械設備操作及組裝人員】女生的薪水是高於男生的，到了07年只有跟男女一樣薪資的職業，沒有女生高於男生薪資的職業了。
```

## 研究所薪資差異

以107年度的資料來看，哪個職業別念研究所最划算呢 (研究所學歷薪資與大學學歷薪資增加比例最多)?

``` r
profession<-education107[,c(2,11,13)]
profession$`大學-薪資`<-gsub("—|…","",profession$`大學-薪資`)
profession$`研究所-薪資`<-gsub("—|…","",profession$`研究所-薪資`)

profession$`大學-薪資`<-as.numeric(as.character(profession$`大學-薪資`))
profession$`研究所-薪資`<-as.numeric(as.character(profession$`研究所-薪資`))
profession<-profession[complete.cases(profession),]
str(profession)
```

    ## Classes 'tbl_df', 'tbl' and 'data.frame':    79 obs. of  3 variables:
    ##  $ 大職業別   : chr  "工業及服務業" "工業及服務業-專業人員" "工業及服務業-技術員及助理專業人員" "工業及服務業-事務支援人員" ...
    ##  $ 大學-薪資  : num  28849 32317 29216 27223 28850 ...
    ##  $ 研究所-薪資: num  33880 37269 32809 30869 33893 ...

``` r
profession$`大學/研究所-薪資`<-profession$`研究所-薪資`/profession$`大學-薪資`
profession[order(profession$`大學/研究所-薪資`,decreasing=T),]%>%head(10)%>%
  knitr::kable()
```

| 大職業別                   | 大學-薪資 | 研究所-薪資 | 大學/研究所-薪資 |
| :--------------------- | :---: | :----: | :-------: |
| 其他服務業                  | 25781 | 31909  | 1.237694  |
| 專業\_科學及技術服務業           | 29353 | 35381  | 1.205362  |
| 專業\_科學及技術服務業-專業人員      | 32460 | 39103  | 1.204652  |
| 教育業-事務支援人員             | 25908 | 30827  | 1.189864  |
| 出版、影音製作、傳播及資通訊服務業      | 29143 | 34503  | 1.183921  |
| 其他服務業-事務支援人員           | 26115 | 30830  | 1.180548  |
| 出版、影音製作、傳播及資通訊服務業-專業人員 | 31763 | 37479  | 1.179958  |
| 製造業                    | 28777 | 33916  | 1.178580  |
| 工業                     | 28850 | 33893  | 1.174801  |
| 工業及服務業                 | 28849 | 33880  | 1.174391  |

``` r
#從事【其他服務業】類別的讀完研究所之後薪資增幅比例最高，這點有出乎我的意料，但是其他的類別的職業都是需要一定的專業知識薪水才會增加，如【專業_科學及技術服務業】就有律師會計師或是建築師這類的，要讀完研究所薪水才會比較優渥。
```

## 我有興趣的職業別薪資狀況分析

### 有興趣的職業別篩選，呈現薪資

``` r
mypro<-profession[grepl("出版、影音製作、傳播及資通訊服務業",profession$大職業別),]
knitr::kable(mypro)
```

| 大職業別                         | 大學-薪資 | 研究所-薪資 | 大學/研究所-薪資 |
| :--------------------------- | :---: | :----: | :-------: |
| 出版、影音製作、傳播及資通訊服務業            | 29143 | 34503  | 1.183921  |
| 出版、影音製作、傳播及資通訊服務業-專業人員       | 31763 | 37479  | 1.179958  |
| 出版、影音製作、傳播及資通訊服務業-技術員及助理專業人員 | 28910 | 33643  | 1.163715  |
| 出版、影音製作、傳播及資通訊服務業-事務支援人員     | 27464 | 30950  | 1.126930  |

``` r
#未來想要當軟體工程師，而這類的薪水跟我預期的差不多，雖然有略低一點，但還在可接受範圍內。
```

### 這些職業別研究所薪資與大學薪資差多少呢？

``` r
mypro$`大學-薪資`<-as.numeric(as.character(mypro$`大學-薪資`))
mypro$`研究所-薪資`<-as.numeric(as.character(mypro$`研究所-薪資`))
mypro$`研究所大學-薪資差異`<-mypro$`研究所-薪資`-mypro$`大學-薪資`
select(mypro,大職業別,`研究所大學-薪資差異`)%>%knitr::kable()
```

| 大職業別                         | 研究所大學-薪資差異 |
| :--------------------------- | :--------: |
| 出版、影音製作、傳播及資通訊服務業            |    5360    |
| 出版、影音製作、傳播及資通訊服務業-專業人員       |    5716    |
| 出版、影音製作、傳播及資通訊服務業-技術員及助理專業人員 |    4733    |
| 出版、影音製作、傳播及資通訊服務業-事務支援人員     |    3486    |

``` r
#差了四五千，覺得加了之後的薪水很棒，還是會想要去念研究所，並不會改變心意不念~~
```
